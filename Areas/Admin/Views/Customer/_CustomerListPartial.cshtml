@model IEnumerable<Hotel_Management.Models.Customer>
@{
}
<div class="table-responsive">
    <table class="table table-flush" id="customerTable">
        <thead class="thead-light">
            <tr>
                <th class="text-uppercase text-secondary text-xs font-weight-bolder opacity-7">ID</th>
                <th class="text-uppercase text-secondary text-xs font-weight-bolder opacity-7 ps-2">Full Name</th>
                <th class="text-uppercase text-secondary text-xs font-weight-bolder opacity-7 ps-2">Email</th>
                <th class="text-uppercase text-secondary text-xs font-weight-bolder opacity-7 ps-2">Phone</th>
                <th class="text-uppercase text-secondary text-xs font-weight-bolder text-center opacity-7">Gender</th>
                <th class="text-uppercase text-secondary text-xs font-weight-bolder text-center opacity-7">Nationality</th>
                <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Action</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var customer in Model)
            {
                <tr>
                    <td>
                        <div class="d-flex px-2 py-1">
                            <div class="d-flex flex-column justify-content-center">
                                @* Định dạng lại ID theo yêu cầu #CID + mã *@
                                <h6 class="mb-0 text-sm">#CID@(customer.CustomerId)</h6>
                            </div>
                        </div>
                    </td>
                    <td>
                        <p class="text-sm font-weight-bold mb-0">@customer.FullName</p>
                    </td>
                    <td>
                        <p class="text-xs mb-0">@customer.Email</p>
                    </td>
                    <td>
                        <p class="text-xs mb-0">@customer.Phone</p>
                    </td>
                    <td class="align-middle text-center">
                        <span class="text-secondary text-xs font-weight-bold">@customer.Gender</span>
                    </td>
                    <td class="align-middle text-center">
                        <span class="text-secondary text-xs font-weight-bold">@customer.Nationality</span>
                    </td>
                    <td class="align-middle text-center">
                        @* Giữ nguyên các nút action *@
                        <a href="@Url.Action("Details", new { id = customer.CustomerId })" class="text-secondary font-weight-bold text-xs me-2 view-details-btn" data-bs-toggle="modal" data-bs-placement="top" title="View Details" data-bs-target="#detailsModal">
                            <i class="material-symbols-rounded">visibility</i>
                        </a>
                        <a href="@Url.Action("Edit", new { id = customer.CustomerId })" class="text-secondary font-weight-bold text-xs me-2 edit-details-btn" data-bs-toggle="modal" data-bs-placement="top" title="Edit" data-bs-target="#detailsModal">
                            <i class="material-symbols-rounded">edit</i>
                        </a>
                        <a href="#" data-id="@customer.CustomerId" data-name="@customer.FullName" class="text-secondary font-weight-bold text-xs delete-button" data-bs-toggle="tooltip" data-bs-placement="top" title="Delete">
                            <i class="material-symbols-rounded">delete</i>
                        </a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
<!-- Pagination -->
<div id="paginationContainer">
    <div class="border-top py-3 px-4">
        <div class="d-flex justify-content-between align-items-center">

            <p class="text-sm mb-0">
                Trang <strong>@(ViewBag.currentPage ?? 1)</strong> / <strong>@(ViewBag.pageNum ?? 1)</strong>
            </p>

            <nav aria-label="Page navigation">
                <ul class="pagination pagination-sm mb-0">
                    @{
                        int currentPage = ViewBag.currentPage ?? 1;
                        int pageNum = ViewBag.pageNum ?? 1;

                        // --- CÀI ĐẶT ---
                        // Số trang lân cận (neighbors) bạn muốn thấy
                        int neighbors = 1;

                        // Tổng số nút tối đa sẽ hiển thị trước khi kích hoạt dấu "..."
                        int maxButtons = (neighbors * 2) + 5; // (Hiện tại là 7 nút)
                    }

                    <li class="page-item @(currentPage == 1 ? "disabled" : "")" page="@(currentPage - 1)">
                        <a class="page-link px-3" href="#">
                            <span aria-hidden="true">&lt;</span>
                        </a>
                    </li>

                    @if (pageNum <= maxButtons)
                    {
                        // TRƯỜNG HỢP 1: SỐ TRANG QUÁ ÍT (<= 7)
                        // In tất cả các số (logic đơn giản)
                        for (int i = 1; i <= pageNum; i++)
                        {
                            <li class="page-item @(i == currentPage ? "active" : "")" page="@i">
                                <a class="page-link" href="#">@i</a>
                            </li>
                        }
                    }
                    else
                    {
                        // TRƯỜNG HỢP 2: SỐ TRANG NHIỀU (> 7)
                        // Dùng logic "thông minh" (có dấu "...").
                        for (int i = 1; i <= pageNum; i++)
                        {
                            // Xác định các "vùng" sẽ được hiển thị
                            bool isFirstPage = (i == 1);
                            bool isLastPage = (i == pageNum);
                            bool isNeighbor = (i >= currentPage - neighbors && i <= currentPage + neighbors);

                            // Xác định vị trí của dấu "..."
                            bool isLeftEllipsis = (i == currentPage - neighbors - 1);
                            bool isRightEllipsis = (i == currentPage + neighbors + 1);

                            if (isFirstPage || isLastPage || isNeighbor)
                            {
                                // HIỂN THỊ NÚT SỐ
                                <li class="page-item @(i == currentPage ? "active" : "")" page="@i">
                                    <a class="page-link" href="#">@i</a>
                                </li>
                            }
                            else if (isLeftEllipsis || isRightEllipsis)
                            {
                                // HIỂN THỊ DẤU "..."
                                <li class="page-item disabled">
                                    <a class="page-link" href="#">...</a>
                                </li>
                            }
                            // Các số khác (quá xa) sẽ bị ẩn đi
                        }
                    }

                    <li class="page-item @(currentPage == pageNum ? "disabled" : "")" page="@(currentPage + 1)">
                        <a class="page-link px-3" href="#">
                            <span aria-hidden="true">&gt;</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>
