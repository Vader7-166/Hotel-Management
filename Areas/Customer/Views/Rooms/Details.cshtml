@using Hotel_Management.Models
@model RoomType

@{
    Layout = "~/Views/Shared/_LayoutCustomer.cshtml";
    ViewData["Title"] = $"Chi Tiết Phòng - {Model.TypeName}";
}

@section Styles {
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        .room-detail-img {
            height: 500px;
            object-fit: cover;
            border-radius: 10px;
        }

        .feature-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 10px;
            transition: all 0.3s;
        }

            .feature-item:hover {
                background: #e9ecef;
                transform: translateY(-2px);
            }

        .price-badge {
            font-size: 2rem;
            font-weight: bold;
            color: #0d6efd;
        }

        .booking-card {
            position: sticky;
            top: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-radius: 12px;
        }
    </style>
}

<div class="container my-5">
    <div class="row g-4">
        <!-- Hình ảnh phòng -->
        <div class="col-lg-7">
            <img src="/images/room/room@(Model.RoomTypeId).jpg"
                 onerror="this.src='/images/room/default.jpg'"
                 class="img-fluid w-100 room-detail-img"
                 alt="@Model.TypeName" />
        </div>

        <!-- Chi tiết phòng -->
        <div class="col-lg-5">
            <div class="card booking-card p-4">
                <h2 class="fw-bold mb-3 text-secondary">@Model.TypeName</h2>
                <p class="mb-3 text-muted">@Model.Description</p>

                <div class="d-flex justify-content-between align-items-center mb-3">
                    <span class="text-secondary">Sức chứa:</span>
                    <span><i class="bi bi-people-fill"></i> @Model.MaxOccupancy người</span>
                </div>

                <div class="d-flex justify-content-between align-items-center mb-3">
                    <span class="text-secondary">Giá cơ bản:</span>
                    <span class="price-badge text-secondary">@Model.BasePrice.ToString("N0") VNĐ</span>
                </div>

                <div class="text-muted mb-3">
                    <small><i class="bi bi-clock-history"></i> Cập nhật: @(Model.UpdatedAt?.ToString("dd/MM/yyyy") ?? "N/A")</small>
                </div>

                <form asp-area="Customer" asp-controller="Booking" asp-action="Create" method="post">
                    <input asp-for="RoomTypeId" type="hidden" />

                    <div class="mb-3">
                        <label class="form-label">Ngày nhận phòng</label>
                        <input type="date" name="CheckInDate" class="form-control" required />
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Ngày trả phòng</label>
                        <input type="date" name="CheckOutDate" class="form-control" required />
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Số lượng người</label>
                        <select name="Guests" class="form-select" required>
                            @for (int i = 1; i <= Model.MaxOccupancy; i++)
                            {
                                <option value="@i">@i người</option>
                            }
                        </select>
                    </div>

                    <button type="submit" class="btn btn-secondary w-100 py-2 fw-bold">
                        <i class="bi bi-calendar-check me-1"></i> Đặt phòng ngay
                    </button>
                </form>

                <div class="mt-4 text-center text-secondary">
                    <a asp-controller="Rooms" asp-action="Index" class="text-decoration-none">
                        <i class="bi bi-arrow-left"></i> Quay lại danh sách
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const checkIn = document.querySelector('input[name="CheckInDate"]');
            const checkOut = document.querySelector('input[name="CheckOutDate"]');
            checkIn.addEventListener('change', function() {
                const date = new Date(this.value);
                if (!isNaN(date)) {
                    const nextDay = new Date(date);
                    nextDay.setDate(date.getDate() + 1);
                    checkOut.min = nextDay.toISOString().split('T')[0];
                }
            });
        });
    </script>
}
